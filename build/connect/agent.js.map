{"version":3,"sources":["../../src/connect/agent.js"],"names":["agent","TypeError","join","has","get","maxSockets","maxFreeSockets","timeout","keepAliveTimeout"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAKA;;;;kBAIe,gBAAsC;AAAA,wBAAnCA,KAAmC;AAAA,MAAnCA,KAAmC;;AACnD,MAAI,CAAC,sBAASA,KAAT,CAAD,IAAoB,CAAC,sBAAcA,KAAd,CAAzB,EAA+C;AAC7C,UAAM,IAAIC,SAAJ,CAAc,CAClB,sDADkB,EAElB,oDAFkB,EAGlB,wFAHkB,EAIlBC,IAJkB,CAIb,IAJa,CAAd,CAAN;AAKD;;AAPkD,cAc/C,sBAAcF,KAAd,IAAuBA,KAAvB,GAA+B,iBAAOG,GAAP,CAAWH,KAAX,IAAoB,iBAAOI,GAAP,CAAWJ,KAAX,CAApB,GAAwC,EAdxB;AAAA,+BAUjDK,UAViD;AAAA,MAUjDA,UAViD;AAAA,mCAWjDC,cAXiD;AAAA,MAWjDA,cAXiD;AAAA,4BAYjDC,OAZiD;AAAA,MAYjDA,OAZiD;AAAA,oCAajDC,gBAbiD;AAAA,MAajDA,gBAbiD;;AAgBnD,SAAO,6BAAU,EAAEH,sBAAF,EAAcC,8BAAd,EAA8BC,gBAA9B,EAAuCC,kCAAvC,EAAV,CAAP;AACD,C","file":"agent.js","sourcesContent":["import config from 'config';\nimport Agent from 'agentkeepalive';\nimport isString from 'lodash.isstring';\nimport isPlainObject from 'lodash.isplainobject';\nimport {\n  CONFIG_SECTION_AGENT,\n  AGENT_MAX_SOCKETS, AGENT_MAX_FREE_SOCKETS, AGENT_TIMEOUT, AGENT_KEEP_ALIVE_TIMEOUT\n} from '../constants';\n\n/**\n * @param {string|object} [agent=CONFIG_SECTION_AGENT]\n * @returns {*}\n */\nexport default ({ agent = CONFIG_SECTION_AGENT }) => {\n  if (!isString(agent) && !isPlainObject(agent)) {\n    throw new TypeError([\n      'Настройки для Agent ElasticSearch могут быть только:',\n      '- {string} -> название имени ключа из конфигурации',\n      '- {object} -> объектом с настройками @see https://www.npmjs.com/package/agentkeepalive',\n    ].join('\\n'))\n  }\n\n  const {\n    maxSockets = AGENT_MAX_SOCKETS,\n    maxFreeSockets  = AGENT_MAX_FREE_SOCKETS,\n    timeout = AGENT_TIMEOUT,\n    keepAliveTimeout = AGENT_KEEP_ALIVE_TIMEOUT\n  } = isPlainObject(agent) ? agent : config.has(agent) ? config.get(agent) : {};\n\n  return new Agent({ maxSockets, maxFreeSockets, timeout, keepAliveTimeout });\n}"]}