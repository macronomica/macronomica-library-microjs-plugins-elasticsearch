{"version":3,"sources":["../../src/connect/elastic.js"],"names":["es","TypeError","join","has","get","host","log","maxSockets","requestTimeout","agent","other","Client","createNodeAgent"],"mappings":";;;;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AASA;;;;kBAIe,gBAAgC;AAAA,qBAA7BA,EAA6B;AAAA,MAA7BA,EAA6B;;AAC7C,MAAI,CAAC,sBAASA,EAAT,CAAD,IAAiB,CAAC,sBAAcA,EAAd,CAAtB,EAAyC;AACvC,UAAM,IAAIC,SAAJ,CAAc,CAClB,6DADkB,EAElB,oDAFkB,EAGlB,yJAHkB,EAIlBC,IAJkB,CAIb,IAJa,CAAd,CAAN;AAKD;;AAP4C,cAgBzC,sBAAcF,EAAd,IAAoBA,EAApB,GAAyB,iBAAOG,GAAP,CAAWH,EAAX,IAAiB,iBAAOI,GAAP,CAAWJ,EAAX,CAAjB,GAAkC,EAhBlB;AAAA,yBAU3CK,IAV2C;AAAA,MAU3CA,IAV2C;AAAA,wBAW3CC,GAX2C;AAAA,MAW3CA,GAX2C;AAAA,+BAY3CC,UAZ2C;AAAA,MAY3CA,UAZ2C;AAAA,mCAa3CC,cAb2C;AAAA,MAa3CA,cAb2C;AAAA,0BAc3CC,KAd2C;AAAA,MAc3CA,KAd2C;AAAA,MAexCC,KAfwC;;AAkB7C,SAAO,IAAI,wBAAcC,MAAlB;AACLN,cADK,EACCC,QADD,EACME,8BADN,EACsBD,sBADtB;AAELK,qBAAiB;AAAA,aAAM,qBAAMH,KAAN,CAAN;AAAA;AAFZ,KAGFC,KAHE,EAAP;AAKD,C","file":"elastic.js","sourcesContent":["import config from 'config';\nimport elasticsearch from 'elasticsearch';\nimport isString from 'lodash.isstring';\nimport isPlainObject from 'lodash.isplainobject';\nimport Agent from './agent';\nimport {\n  CONFIG_SECTION_ES,\n  CONFIG_SECTION_AGENT,\n  ES_HOST,\n  ES_LOG,\n  ES_REQUEST_TIMEOUT,\n  ES_MAX_SOCKETS,\n} from '../constants';\n\n/**\n * @param {string|object} [es]=CONFIG_SECTION_ES\n * @returns {*}\n */\nexport default ({ es = CONFIG_SECTION_ES }) => {\n  if (!isString(es) || !isPlainObject(es)) {\n    throw new TypeError([\n      'Настройки для соединения с ElasticSearch могут быть только:',\n      '- {string} -> название имени ключа из конфигурации',\n      '- {object} -> объектом с настройками @see https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/configuration.html#config-options',\n    ].join('\\n'))\n  }\n\n  const {\n    host = ES_HOST,\n    log = ES_LOG,\n    maxSockets = ES_MAX_SOCKETS,\n    requestTimeout = ES_REQUEST_TIMEOUT,\n    agent = CONFIG_SECTION_AGENT,\n    ...other\n  } = isPlainObject(es) ? es : config.has(es) ? config.get(es) : {};\n\n  return new elasticsearch.Client({\n    host, log, requestTimeout, maxSockets,\n    createNodeAgent: () => Agent(agent),\n    ...other\n  });\n}"]}